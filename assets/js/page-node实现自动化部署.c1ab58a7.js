(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{799:function(s,n,t){"use strict";t.r(n);var a=t(1),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"node实现自动化部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node实现自动化部署"}},[s._v("#")]),s._v(" node实现自动化部署；")]),s._v(" "),t("blockquote",[t("p",[s._v("说明：由于本人做的前端，Java就不太会，但是node确实一个对于前端同学写后端代码的一个非常好的技术。个人的项目前端是"),t("code",[s._v("vue")]),s._v("写的后端是"),t("code",[s._v("Nodejs")]),s._v(",同时利用"),t("code",[s._v("jenkjins")]),s._v("实现前后端自动化部署。")])]),s._v(" "),t("h2",{attrs:{id:"_1、项目上传"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、项目上传"}},[s._v("#")]),s._v(" 1、项目上传；")]),s._v(" "),t("blockquote",[t("p",[s._v("前端项目这里就不在概括，以下内容都是node部署内容；注：Node项目写完之后，不需要打包，直接把源码上传到你的远程服务器就可以了，我的服务器用的是阿里云Liunx服务器，下文提到的服务器皆为阿里云服务器。")])]),s._v(" "),t("ol",[t("li",[s._v("把你的Node项目进行打包。(node_modules文件不要打包)。")]),s._v(" "),t("li",[s._v("登录你的服务器，然后新建一个文件夹。")]),s._v(" "),t("li",[s._v("把你的node代码上传到你的新建文件夹中。")]),s._v(" "),t("li",[s._v("把你的上传的Node项目解压缩到你的新建文件夹中。")])]),s._v(" "),t("h2",{attrs:{id:"_2、jenkins实现半自动化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、jenkins实现半自动化"}},[s._v("#")]),s._v(" 2、"),t("code",[s._v("jenkins")]),s._v("实现半自动化；")]),s._v(" "),t("blockquote",[t("p",[s._v("为什么这里说是半自动化，因为实现了push拉取代码；但是Node并不会"),t("strong",[s._v("自动启动")]),s._v("；")])]),s._v(" "),t("ol",[t("li",[t("p",[s._v("登录你的jenkins并新建立一个项目。")])]),s._v(" "),t("li",[t("p",[s._v("配置你的jenkins的shell命令。")])]),s._v(" "),t("li",[t("p",[s._v("具体的jenkins的git配置请查看我的另外一骗文章，传送门。")])]),s._v(" "),t("li",[t("p",[s._v("我的jenkins配置文件；")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/lib/jenkins/workspace/herolist "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入Jenkins工作空间下herolist项目目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf heroList.tar.gz * "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把生成的项目打包成压缩包，方便移动到项目部署目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /www/herolist "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入node项目根目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /var/lib/jenkins/workspace/heroList/heroList.tar.gz ./  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移动刚刚打包好的项目到web项目根目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf heroList.tar.gz  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压项目到本目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf heroList.tar.gz "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除压缩包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装项目中的依赖")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm run dev # 项目启动。")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("blockquote",[t("p",[s._v("注意：当我们做到这里时，基本就算搞定了，但是还缺少重要的一步，就是node服务启动。")]),s._v(" "),t("p",[s._v("当一切都感觉完好时，却发现最后一行node服务启动报错，不过我没解决掉，具体的报错原因是："),t("code",[s._v("Error: Cannot find module 'express'")]),s._v("。"),t("strong",[s._v("我的操作")]),s._v("是在Liunx手动"),t("code",[s._v("npm run dev")]),s._v("运行是完好的，但是带来了另一个问题，远程服务不能关闭，不然Node就挂了，在网上找了不少方法可以使用，"),t("code",[s._v("nohup npm run dev >myout.file 2>&1 &")]),s._v(" 持续运行node并把信息输出到指定的文件中,这样启动的Node服务就不会因为你退出终端而停止了。")]),s._v(" "),t("p",[t("strong",[s._v("但是另一个问题便是，你用jjenkins进行新的构建时，node并不会重启，来加载你的新代码")]),s._v("。"),t("strong",[s._v("看下文pm2解决")]),s._v("；")])])])]),s._v(" "),t("h2",{attrs:{id:"_3、jenkins-node-pm2实现自动化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、jenkins-node-pm2实现自动化"}},[s._v("#")]),s._v(" 3、"),t("code",[s._v("jenkins + node + pm2")]),s._v("实现自动化；")]),s._v(" "),t("p",[s._v("条件：")]),s._v(" "),t("ul",[t("li",[s._v("已完成jenkins和git的配置，")]),s._v(" "),t("li",[s._v("已经可以成功部署实现自动化；")])]),s._v(" "),t("p",[t("strong",[s._v("1、安装"),t("code",[s._v("pm2")]),s._v("；")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm2 -g\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("测试；出现以下类似列表说明安装成功；")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pm2 list")]),s._v("\n┌─────┬────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐\n│ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("  │ name   │ namespace   │ version │ mode    │ pid      │ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v(" │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │\n├─────┼────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   │ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v("    │ default     │ N/A     │ fork    │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("   │ stopped   │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%       │ 0b       │ root     │ disabled │\n└─────┴────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("strong",[s._v("2、使用；")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在你的Jenkins的项目配置文件的shell命令中在最后一行加上：")]),s._v("\npm2 restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" -- run dev "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启nodejs")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("3、测试")]),s._v("；")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef | grep node ")]),s._v("\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8981")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6550")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":29 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" --color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto node "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node启动前")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef | grep node ")]),s._v("\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9101")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9088")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":29 ?        00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NODE_ENV")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("production "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" node app.js\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9102")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9101")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":29 ?        00:00:00 node app.js "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# node启动后")]),s._v("\nroot      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9126")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6550")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":30 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" --color"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto node\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("strong",[s._v("4、常见pm2命令介绍")]),s._v("；"),t("a",{attrs:{href:"https://www.cnblogs.com/ywnh/p/14287631.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),t("OutboundLink")],1),s._v("；")]),s._v(" "),t("p",[s._v("到此自动化部署结束；")]),s._v(" "),t("h2",{attrs:{id:"_4、问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、问题"}},[s._v("#")]),s._v(" 4、问题；")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("jenkins执行pm2命令报错；"),t("code",[s._v("pm2: command not found")]),s._v("；")]),s._v(" "),t("blockquote",[t("p",[s._v("一般情况下，如果我们全局安装了的话，在window上不会出现，但是liunx上好像不行，需要我们自己手动建立软连接，类似与window创建的环境变量。部分用户可能安装上 连基础的命令也不能使用，也是需要建立软连接的；")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("以上省略！\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("heroList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ /bin/sh -xe /tmp/jenkins4753469389532234169.sh\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("heroList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ /bin/sh -xe /tmp/jenkins259913818346979744.sh\n+ pm2 start "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" -- run dev\n/tmp/jenkins259913818346979744.sh: line "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(": pm2: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" not found\nBuild step "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Execute shell'")]),s._v(" marked build as failure\nFinished: FAILURE\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("解决：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到pm2的安装根目录；我的：/home/local/mynode/node-v12.18.2-linux-x64/bin/pm2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm install -g pm2 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" WARN deprecated debug@4.1.1: Debug versions "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.3")]),s._v(".1 have a low-severity ReDos regression when used "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a Node.js environment. It is recommended you upgrade to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".7 or "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.3")]),s._v(".1. "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("https://github.com/visionmedia/debug/issues/797"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n/home/local/mynode/node-v12.18.2-linux-x64/bin/pm2 -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/local/mynode/node-v12.18.2-linux-x64/lib/node_modules/pm2/bin/pm2\n/home/local/mynode/node-v12.18.2-linux-x64/bin/pm2-dev -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/local/mynode/node-v12.18.2-linux-x64/lib/node_modules/pm2/bin/pm2-dev\n/home/local/mynode/node-v12.18.2-linux-x64/bin/pm2-docker -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/local/mynode/node-v12.18.2-linux-x64/lib/node_modules/pm2/bin/pm2-docker\n/home/local/mynode/node-v12.18.2-linux-x64/bin/pm2-runtime -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/local/mynode/node-v12.18.2-linux-x64/lib/node_modules/pm2/bin/pm2-runtime\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" WARN ws@7.2.5 requires a peer of bufferutil@^4.0.1 but none is installed. You must "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" peer dependencies yourself.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" WARN ws@7.2.5 requires a peer of utf-8-validate@^5.0.2 but none is installed. You must "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" peer dependencies yourself.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.3.1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("node_modules/pm2/node_modules/fsevents"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" fsevents@2.3.1: wanted "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"os"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"darwin"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arch"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"any"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"os"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"arch"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x64"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n+ pm2@4.5.1\nadded "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("195")]),s._v(" packages from "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("195")]),s._v(" contributors "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".346s\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ herolist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到环境变量路径 %PATH; ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo $PATH")]),s._v("\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/home/local/JDK/jdk1.8.0_251/bin:/home/local/mynode/node-v12.18.2-linux-x64/bin:/home/local/maven/apache-maven-3.6.3/bin:/root/bin\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立软连接；")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZbp156pkpio44mis76wmxZ /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s /home/local/mynode/node-v12.18.2-linux-x64/bin/pm2 /usr/local/bin/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("blockquote",[t("p",[s._v("注意：第一次建立软连接后，我并没有解决 "),t("code",[s._v("pm2: command not found")]),s._v("。需要 /usr/local/bin/ 改为 /usr/bin/")]),s._v(" "),t("p",[s._v("完整命令："),t("code",[s._v("ln -s /home/local/mynode/node-v12.18.2-linux-x64/bin/pm2 /usr/bin/")])])])]),s._v(" "),t("li",[t("p",[s._v("测试；jenkins控制台输出日志；")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("以上省略！\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("heroList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ /bin/sh -xe /tmp/jenkins4043641238157935034.sh\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("heroList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ /bin/sh -xe /tmp/jenkins4997403699140616984.sh\n+ pm2 start "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" -- run dev\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PM2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Applying action restartProcessId on app "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("npm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ids: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PM2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("npm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ✓\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PM2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Process successfully started\n┌─────┬────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐\n│ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("  │ name   │ namespace   │ version │ mode    │ pid      │ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v(" │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │\n├─────┼────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤\n│ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   │ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v("    │ default     │ N/A     │ fork    │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10506")]),s._v("    │ 0s     │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("   │ online    │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%       │ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".5mb    │ root     │ disabled │\n└─────┴────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘\nFinished: SUCCESS\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])])])])])}),[],!1,null,null,null);n.default=e.exports}}]);